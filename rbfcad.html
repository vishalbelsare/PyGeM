

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Radial Basis Function [CAD] &mdash; PyGeM 2.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inverse Distance Weighting [CAD]" href="idwcad.html" />
    <link rel="prev" title="Free-form Deformation [CAD]" href="ffdcad.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PyGeM
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="code.html">Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ffd.html">Free-form Deformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbf.html">Radial Basis Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbf_factory.html">RBF Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="idw.html">Inverse Distance Weighting</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom_deformation.html">Custom Deformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="filehandler.html">Filehandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtkhandler.html">Vtkhandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="stlhandler.html">Stlhandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="openfhandler.html">Openfhandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="unvhandler.html">Unvhandler</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="code.html#cad">CAD</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cad_deformation.html">CAD Deformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ffdcad.html">Free-form Deformation [CAD]</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Radial Basis Function [CAD]</a></li>
<li class="toctree-l3"><a class="reference internal" href="idwcad.html">Inverse Distance Weighting [CAD]</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_deformation_cad.html">Custom Deformation [CAD]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="code.html#table-of-contents">Table of contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyGeM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="code.html">Code Documentation</a> &raquo;</li>
        
      <li>Radial Basis Function [CAD]</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rbfcad.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pygem.cad.rbf">
<span id="radial-basis-function-cad"></span><h1>Radial Basis Function [CAD]<a class="headerlink" href="#module-pygem.cad.rbf" title="Permalink to this headline">¶</a></h1>
<p>Module focused on the implementation of the Radial Basis Functions interpolation
technique.  This technique is still based on the use of a set of parameters, the
so-called control points, as for FFD, but RBF is interpolatory. Another
important key point of RBF strategy relies in the way we can locate the control
points: in fact, instead of FFD where control points need to be placed inside a
regular lattice, with RBF we hano no more limitations. So we have the
possibility to perform localized control points refiniments.
The module is analogous to the freeform one.</p>
<dl class="field-list">
<dt class="field-odd">Theoretical Insight</dt>
<dd class="field-odd"><p>As reference please consult M.D. Buhmann, Radial Basis Functions, volume 12
of Cambridge monographs on applied and computational mathematics. Cambridge
University Press, UK, 2003.  This implementation follows D. Forti and G.
Rozza, Efficient geometrical parametrization techniques of interfaces for
reduced order modelling: application to fluid-structure interaction coupling
problems, International Journal of Computational Fluid Dynamics.</p>
<p>RBF shape parametrization technique is based on the definition of a map,
<span class="math">\mathcal{M}(\boldsymbol{x}) : \mathbb{R}^n \rightarrow
\mathbb{R}^n</span>, that allows the possibility of transferring data across
non-matching grids and facing the dynamic mesh handling. The map introduced
is defines as follows</p>
<div class="math">
<p><span class="math">\mathcal{M}(\boldsymbol{x}) = p(\boldsymbol{x}) + 
\sum_{i=1}^{\mathcal{N}_C} \gamma_i
\varphi(\| \boldsymbol{x} - \boldsymbol{x_{C_i}} \|)</span></p>
</div><p>where <span class="math">p(\boldsymbol{x})</span> is a low_degree polynomial term,
<span class="math">\gamma_i</span> is the weight, corresponding to the a-priori selected
<span class="math">\mathcal{N}_C</span> control points, associated to the <span class="math">i</span>-th basis
function, and <span class="math">\varphi(\| \boldsymbol{x} - \boldsymbol{x_{C_i}}
\|)</span> a radial function based on the Euclidean distance between the control
points position <span class="math">\boldsymbol{x_{C_i}}</span> and <span class="math">\boldsymbol{x}</span>.
A radial basis function, generally, is a real-valued function whose value
depends only on the distance from the origin, so that
<span class="math">\varphi(\boldsymbol{x}) = \tilde{\varphi}(\| \boldsymbol{x}
\|)</span>.</p>
<p>The matrix version of the formula above is:</p>
<div class="math">
<p><span class="math">\mathcal{M}(\boldsymbol{x}) = \boldsymbol{c} +
\boldsymbol{Q}\boldsymbol{x} +
\boldsymbol{W^T}\boldsymbol{d}(\boldsymbol{x})</span></p>
</div><p>The idea is that after the computation of the weights and the polynomial
terms from the coordinates of the control points before and after the
deformation, we can deform all the points of the mesh accordingly.  Among
the most common used radial basis functions for modelling 2D and 3D shapes,
we consider Gaussian splines, Multi-quadratic biharmonic splines, Inverted
multi-quadratic biharmonic splines, Thin-plate splines, Beckert and
Wendland <span class="math">C^2</span> basis and Polyharmonic splines all defined and
implemented below.</p>
</dd>
</dl>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py class">
<dt>
<em class="property">class </em><code class="sig-name descname">RBF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">original_control_points</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">deformed_control_points</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">'gaussian_spline'</span></em>, <em class="sig-param"><span class="n">radius</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">extra_parameter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">u_knots_to_add</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">v_knots_to_add</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">t_knots_to_add</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">tolerance</span><span class="o">=</span><span class="default_value">0.0001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pygem/cad/rbf.html#RBF"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pygem.cad.cad_deformation.CADDeformation</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">pygem.rbf.RBF</span></code></p>
<p>Class that handles the Radial Basis Functions interpolation on CAD
geometries.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_control_points</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – it is an
(<em>n_control_points</em>, <em>3</em>) array with the coordinates of the original
interpolation control points before the deformation. The default is the
vertices of the unit cube.</p></li>
<li><p><strong>deformed_control_points</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – it is an
(<em>n_control_points</em>, <em>3</em>) array with the coordinates of the
interpolation control points after the deformation. The default is the
vertices of the unit cube.</p></li>
<li><p><strong>func</strong> – the basis function to use in the transformation. Several basis
function are already implemented and they are available through the
<code class="xref py py-class docutils literal notranslate"><span class="pre">RBFFactory</span></code> by passing the name of the right
function (see class documentation for the updated list of basis
function).  A callable object can be passed as basis function. Default
is ‘gaussian_spline’.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the scaling parameter r that affects the shape of the
basis functions.  For details see the class
<code class="xref py py-class docutils literal notranslate"><span class="pre">RBF</span></code>. The default value is 0.5.</p></li>
<li><p><strong>extra_parameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the additional parameters that may be passed to
the kernel function. Default is None.</p></li>
<li><p><strong>u_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS surfaces
along <cite>u</cite> direction before the deformation. This parameter is useful
whenever the gradient of the imposed deformation present spatial scales
that are smaller than the local distance among the original poles of
the surface/curve. Enriching the poles will allow for a more accurate
application of the deformation, and might also reduce possible
mismatches between bordering faces. On the orther hand, it might result
in higher computational cost and bigger output files. Default is 0.</p></li>
<li><p><strong>v_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS surfaces
along <cite>v</cite> direction before the deformation. This parameter is useful
whenever the gradient of the imposed deformation present spatial scales
that are smaller than the local distance among the original poles of
the surface/curve. Enriching the poles will allow for a more accurate
application of the deformation, and might also reduce possible
mismatches between bordering faces. On the orther hand, it might result
in higher computational cost and bigger output files.  Default is 0.</p></li>
<li><p><strong>t_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS curves
before the deformation. This parameter is useful whenever the gradient
of the imposed deformation present spatial scales that are smaller than
the local distance among the original poles of the surface/curve.
Enriching the poles will allow for a more accurate application of the
deformation, and might also reduce possible mismatches between
bordering faces. On the orther hand, it might result in higher
computational cost and bigger output files. Default is 0.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the tolerance involved in several internal
operations of the procedure (joining wires in a single curve before
deformation and placing new poles on curves and surfaces). Change the
default value only if the input file scale is significantly different
form mm, making some of the aforementioned operations fail. Default is
0.0001.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – the matrix formed by the weights corresponding
to the a-priori selected N control points, associated to the basis
functions and c and Q terms that describe the polynomial of order one
p(x) = c + Qx.  The shape is (n_control_points+1+3)-by-3. It is computed
internally.</p></li>
<li><p><strong>original_control_points</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – it is an
(<em>n_control_points</em>, <em>3</em>) array with the coordinates of the original
interpolation control points before the deformation.</p></li>
<li><p><strong>deformed_control_points</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – it is an
(<em>n_control_points</em>, <em>3</em>) array with the coordinates of the
interpolation control points after the deformation.</p></li>
<li><p><strong>basis</strong> (<em>callable</em>) – the basis functions to use in the
transformation.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the scaling parameter that affects the shape of the
basis functions.</p></li>
<li><p><strong>extra_parameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the additional parameters that may be passed to
the kernel function.</p></li>
<li><p><strong>u_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS surfaces
along <cite>u</cite> direction before the deformation.</p></li>
<li><p><strong>v_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS surfaces
along <cite>v</cite> direction before the deformation.</p></li>
<li><p><strong>t_knots_to_add</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of knots to add to the NURBS curves
before the deformation.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the tolerance involved in several internal
operations of the procedure (joining wires in a single curve before
deformation and placing new poles on curves and surfaces).</p></li>
</ul>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygem.cad</span> <span class="kn">import</span> <span class="n">RBF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rbf</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rbf</span><span class="o">.</span><span class="n">read_parameters</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="s1">&#39;tests/test_datasets/parameters_test_ffd_iges.prm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_cad_file_name</span> <span class="o">=</span> <span class="s2">&quot;input.iges&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_cad_file_name</span> <span class="o">=</span> <span class="s2">&quot;output.iges&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rbf</span><span class="p">(</span><span class="n">input_cad_file_name</span><span class="p">,</span> <span class="n">modified_cad_file_name</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="idwcad.html" class="btn btn-neutral float-right" title="Inverse Distance Weighting [CAD]" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ffdcad.html" class="btn btn-neutral float-left" title="Free-form Deformation [CAD]" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2017-2020, PyGeM contributors
      <span class="lastupdated">
        Last updated on Jul 08, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>